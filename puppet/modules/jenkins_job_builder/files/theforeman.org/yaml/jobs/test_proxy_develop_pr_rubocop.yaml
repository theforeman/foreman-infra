- job:
    name: test_proxy_develop_pr_rubocop_temp
    description: |
      Run Rubocop tests against develop branch on PR.
    concurrent: true
    logrotate:
      daysToKeep: 45
      numToKeep: -1
    properties:
      - github:
          url: https://github.com/theforeman/smart-proxy
    parameters:
      - pr_parameters
      - string:
          name: branch
          default: develop
          description: |
            Base branch to merge PR into
    scm:
      - git:
          url: https://github.com/theforeman/smart-proxy
          wipe-workspace: true
          prune: true
          branches:
            - 'upstream/${branch}'
    wrappers:
      - timeout:
          type: likely-stuck
          abort: true
          timeout: 60
          timeout-var: 'BUILD_TIMEOUT'
          write-description: "Build timed out (after ${BUILD_TIMEOUT} minutes). Marking the build as aborted."
    builders:
      - shell: |
          #!/bin/bash -ex
          git remote add pr ${pr_git_url}
          git fetch pr
          git merge pr/${pr_git_ref}
      - shell: !include-raw: scripts/test/test_proxy_develop_pr_rubocop.sh
    publishers:
      - checkstyle:
          pattern: 'rubocop.xml'
      - gemset_cleanup
